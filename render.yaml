# Render Blueprint Configuration
# This file automates the deployment process on Render
# Docs: https://render.com/docs/blueprint-spec

services:
  # Backend API Service
  - type: web
    name: balancebot-api
    env: docker
    region: oregon  # Choose: oregon, frankfurt, singapore
    plan: free  # or: starter ($7/mo), standard ($25/mo)
    branch: main
    dockerfilePath: ./Dockerfile
    dockerContext: .

    # Health Check - Simple endpoint that responds immediately
    # Using /ping instead of /api/health for faster cold start recovery
    healthCheckPath: /ping

    # Auto-deploy on git push
    autoDeploy: true

    # Environment Variables
    envVars:
      - key: FLASK_ENV
        value: production

      - key: FLASK_DEBUG
        value: 0

      - key: HOST
        value: 0.0.0.0

      # PORT is automatically provided by Render (10000 for web services)
      # Do not override it - let Render set it

      - key: DATABASE_PATH
        value: backend/nutrition_app.db

      - key: UPLOAD_FOLDER
        value: backend/uploads

      - key: MAX_UPLOAD_SIZE_MB
        value: 16

      - key: RATE_LIMIT_ENABLED
        value: 1

      - key: RATE_LIMIT_PER_MINUTE
        value: 60

      - key: LOG_LEVEL
        value: INFO

      - key: LOG_FILE
        value: app.log

      # IMPORTANT: Add these manually in Render dashboard (they contain secrets)
      # - GOOGLE_API_KEY (required - from https://aistudio.google.com/apikey)
      # - SECRET_KEY (required - generate with: python3 -c "import secrets; print(secrets.token_hex(32))")
      # - ALLOWED_ORIGINS (set to: https://balancebotai.netlify.app)
